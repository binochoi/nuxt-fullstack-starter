import e from"node:process";globalThis._importMeta_={url:import.meta.url,env:e.env};import{tmpdir as t}from"node:os";import n from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/destr@2.0.5/node_modules/destr/dist/index.mjs";import{defineEventHandler as r,handleCacheHeaders as o,splitCookiesString as s,createEvent as a,fetchWithEvent as i,isEvent as c,eventHandler as l,setHeaders as d,sendRedirect as u,proxyRequest as p,getRequestURL as f,getRequestHeader as m,getResponseHeader as h,getRequestHeaders as g,setResponseHeaders as b,setResponseStatus as k,send as y,createError as w,appendResponseHeader as _,removeResponseHeader as v,setResponseHeader as x,createApp as U,createRouter as A,toNodeListener as j,lazyEventHandler as N,getRouterParam as R,readBody as E,getQuery as C,toWebRequest as S}from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/h3@1.15.4/node_modules/h3/dist/index.mjs";import{createHooks as P}from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/hookable@5.5.3/node_modules/hookable/dist/index.mjs";import{createFetch as $,Headers as T}from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/ofetch@1.4.1/node_modules/ofetch/dist/node.mjs";import{fetchNodeRequestHandler as W,callNodeRequestHandler as z}from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/node-mock-http@1.0.1/node_modules/node-mock-http/dist/index.mjs";import{parseURL as O,withoutBase as I,joinURL as H,getQuery as F,withQuery as q,decodePath as D,withLeadingSlash as L,withoutTrailingSlash as M}from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/ufo@1.6.1/node_modules/ufo/dist/index.mjs";import{createStorage as K,prefixStorage as B}from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/unstorage@1.16.1_@netlify+blobs@10.0.6_db0@0.3.2_better-sqlite3@12.2.0_drizzle-orm@0.44_28e549d500f2c2ad4dd79c211c7c6500/node_modules/unstorage/dist/index.mjs";import V from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/unstorage@1.16.1_@netlify+blobs@10.0.6_db0@0.3.2_better-sqlite3@12.2.0_drizzle-orm@0.44_28e549d500f2c2ad4dd79c211c7c6500/node_modules/unstorage/drivers/fs.mjs";import{digest as J}from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/ohash@2.0.11/node_modules/ohash/dist/index.mjs";import{AsyncLocalStorage as G}from"node:async_hooks";import{getContext as X}from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/unctx@2.4.1/node_modules/unctx/dist/index.mjs";import Z,{defuFn as Q,defu as Y}from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/defu@6.1.4/node_modules/defu/dist/defu.mjs";import{toRouteMatcher as ee,createRouter as te}from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/radix3@1.1.2/node_modules/radix3/dist/index.mjs";import{readFile as ne}from"node:fs/promises";import{resolve as re,dirname as oe,join as se}from"node:path";import ae from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/consola@3.4.2/node_modules/consola/dist/index.mjs";import{ErrorParser as ie}from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/youch-core@0.3.3/node_modules/youch-core/build/index.js";import{Youch as ce}from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/youch@4.1.0-beta.8/node_modules/youch/build/index.js";import{SourceMapConsumer as le}from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/source-map@0.7.4/node_modules/source-map/source-map.js";import{promises as de}from"node:fs";import{fileURLToPath as ue}from"node:url";import{dirname as pe,resolve as fe}from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/pathe@2.0.3/node_modules/pathe/dist/index.mjs";import{Server as me}from"node:http";import he from"node:crypto";import{parentPort as ge,threadId as be}from"node:worker_threads";import{klona as ke}from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/klona@2.0.6/node_modules/klona/dist/index.mjs";import{snakeCase as ye}from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/scule@1.3.0/node_modules/scule/dist/index.mjs";import{betterAuth as we}from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/better-auth@1.3.2/node_modules/better-auth/dist/index.mjs";import{drizzleAdapter as _e}from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/better-auth@1.3.2/node_modules/better-auth/dist/adapters/drizzle-adapter/index.mjs";import{genericOAuth as ve}from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/better-auth@1.3.2/node_modules/better-auth/dist/plugins/index.mjs";import xe from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/postgres@3.4.7/node_modules/postgres/src/index.js";import{drizzle as Ue}from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/drizzle-orm@0.44.3_@prisma+client@6.12.0_typescript@5.8.3__@types+better-sqlite3@7.6.13_5f47fb158e07eda5e3a0bf4fc13b511c/node_modules/drizzle-orm/postgres-js/index.js";import{pgTable as Ae,timestamp as je,text as Ne,boolean as Re}from"file:///Users/bino/Workspaces/nuxt-fullstack-starter/node_modules/.pnpm/drizzle-orm@0.44.3_@prisma+client@6.12.0_typescript@5.8.3__@types+better-sqlite3@7.6.13_5f47fb158e07eda5e3a0bf4fc13b511c/node_modules/drizzle-orm/pg-core/index.js";const Ee=[{baseName:"server",dir:"/Users/bino/Workspaces/nuxt-fullstack-starter/server/src/assets"}],Ce=K();for(const e of Ee)Ce.mount(e.baseName,V({base:e.dir,ignore:e?.ignore||[]}));const Se=K({});function useStorage(e=""){return e?B(Se,e):Se}Se.mount("/assets",Ce),Se.mount("root",V({driver:"fs",readOnly:!0,base:"/Users/bino/Workspaces/nuxt-fullstack-starter/server"})),Se.mount("src",V({driver:"fs",readOnly:!0,base:"/Users/bino/Workspaces/nuxt-fullstack-starter/server/src"})),Se.mount("build",V({driver:"fs",readOnly:!1,base:"/Users/bino/Workspaces/nuxt-fullstack-starter/server/.nitro"})),Se.mount("cache",V({driver:"fs",readOnly:!1,base:"/Users/bino/Workspaces/nuxt-fullstack-starter/server/.nitro/cache"})),Se.mount("data",V({driver:"fs",base:"/Users/bino/Workspaces/nuxt-fullstack-starter/server/.data/kv"}));const Pe=(()=>{class Hasher2{buff="";#e=new Map;write(e){this.buff+=e}dispatch(e){return this[null===e?"null":typeof e](e)}object(e){if(e&&"function"==typeof e.toJSON)return this.object(e.toJSON());const t=Object.prototype.toString.call(e);let n="";const r=t.length;n=r<10?"unknown:["+t+"]":t.slice(8,r-1),n=n.toLowerCase();let o=null;if(void 0!==(o=this.#e.get(e)))return this.dispatch("[CIRCULAR:"+o+"]");if(this.#e.set(e,this.#e.size),"undefined"!=typeof Buffer&&Buffer.isBuffer&&Buffer.isBuffer(e))return this.write("buffer:"),this.write(e.toString("utf8"));if("object"!==n&&"function"!==n&&"asyncfunction"!==n)this[n]?this[n](e):this.unknown(e,n);else{const t=Object.keys(e).sort(),n=[];this.write("object:"+(t.length+n.length)+":");const dispatchForKey=t=>{this.dispatch(t),this.write(":"),this.dispatch(e[t]),this.write(",")};for(const e of t)dispatchForKey(e);for(const e of n)dispatchForKey(e)}}array(e,t){if(t=void 0!==t&&t,this.write("array:"+e.length+":"),!t||e.length<=1){for(const t of e)this.dispatch(t);return}const n=new Map,r=e.map(e=>{const t=new Hasher2;t.dispatch(e);for(const[e,r]of t.#e)n.set(e,r);return t.toString()});return this.#e=n,r.sort(),this.array(r,!1)}date(e){return this.write("date:"+e.toJSON())}symbol(e){return this.write("symbol:"+e.toString())}unknown(e,t){if(this.write(t),e)return this.write(":"),e&&"function"==typeof e.entries?this.array([...e.entries()],!0):void 0}error(e){return this.write("error:"+e.toString())}boolean(e){return this.write("bool:"+e)}string(e){this.write("string:"+e.length+":"),this.write(e)}function(e){this.write("fn:"),!function(e){if("function"!=typeof e)return!1;return"[native code] }"===Function.prototype.toString.call(e).slice(-15)}(e)?this.dispatch(e.toString()):this.dispatch("[native]")}number(e){return this.write("number:"+e)}null(){return this.write("Null")}undefined(){return this.write("Undefined")}regexp(e){return this.write("regex:"+e.toString())}arraybuffer(e){return this.write("arraybuffer:"),this.dispatch(new Uint8Array(e))}url(e){return this.write("url:"+e.toString())}map(e){this.write("map:");const t=[...e];return this.array(t,!1)}set(e){this.write("set:");const t=[...e];return this.array(t,!1)}bigint(e){return this.write("bigint:"+e.toString())}}for(const e of["uint8array","uint8clampedarray","unt8array","uint16array","unt16array","uint32array","unt32array","float32array","float64array"])Hasher2.prototype[e]=function(t){return this.write(e+":"),this.array([...t],!1)};return Hasher2})();function hash(e){return J("string"==typeof e?e:function(e){const t=new Pe;return t.dispatch(e),t.buff}(e)).replace(/[-_]/g,"").slice(0,10)}function defineCachedFunction(e,t={}){t={name:"_",base:"/cache",swr:!0,maxAge:1,...t};const n={},r=t.group||"nitro/functions",o=t.name||e.name||"_",s=t.integrity||hash([e,t]),a=t.validate||(e=>void 0!==e.value);return async(...i)=>{if(await(t.shouldBypassCache?.(...i)))return e(...i);const l=await(t.getKey||getKey)(...i),d=await(t.shouldInvalidateCache?.(...i)),u=await async function(e,i,c,l){const d=[t.base,r,o,e+".json"].filter(Boolean).join(":").replace(/:\/$/,":index");let u=await useStorage().getItem(d).catch(e=>{console.error("[cache] Cache read error.",e),useNitroApp().captureError(e,{event:l,tags:["cache"]})})||{};if("object"!=typeof u){u={};const e=new Error("Malformed data read from cache.");console.error("[cache]",e),useNitroApp().captureError(e,{event:l,tags:["cache"]})}const p=1e3*(t.maxAge??0);p&&(u.expires=Date.now()+p);const f=c||u.integrity!==s||p&&Date.now()-(u.mtime||0)>p||!1===a(u),m=f?(async()=>{const r=n[e];r||(void 0!==u.value&&(t.staleMaxAge||0)>=0&&!1===t.swr&&(u.value=void 0,u.integrity=void 0,u.mtime=void 0,u.expires=void 0),n[e]=Promise.resolve(i()));try{u.value=await n[e]}catch(t){throw r||delete n[e],t}if(!r&&(u.mtime=Date.now(),u.integrity=s,delete n[e],!1!==a(u))){let e;t.maxAge&&!t.swr&&(e={ttl:t.maxAge});const n=useStorage().setItem(d,u,e).catch(e=>{console.error("[cache] Cache write error.",e),useNitroApp().captureError(e,{event:l,tags:["cache"]})});l?.waitUntil&&l.waitUntil(n)}})():Promise.resolve();return void 0===u.value?await m:f&&l&&l.waitUntil&&l.waitUntil(m),t.swr&&!1!==a(u)?(m.catch(e=>{console.error("[cache] SWR handler error.",e),useNitroApp().captureError(e,{event:l,tags:["cache"]})}),u):m.then(()=>u)}(l,()=>e(...i),d,i[0]&&c(i[0])?i[0]:void 0);let p=u.value;return t.transform&&(p=await t.transform(u,...i)||p),p}}function getKey(...e){return e.length>0?hash(e):""}function escapeKey(e){return String(e).replace(/\W/g,"")}function cloneWithProxy(e,t){return new Proxy(e,{get:(e,n,r)=>n in t?t[n]:Reflect.get(e,n,r),set:(e,n,r,o)=>n in t?(t[n]=r,!0):Reflect.set(e,n,r,o)})}const cachedEventHandler=function(e,t={name:"_",base:"/cache",swr:!0,maxAge:1}){const n=(t.varies||[]).filter(Boolean).map(e=>e.toLowerCase()).sort(),c={...t,getKey:async e=>{const r=await(t.getKey?.(e));if(r)return escapeKey(r);const o=e.node.req.originalUrl||e.node.req.url||e.path;let s;try{s=escapeKey(decodeURI(O(o).pathname)).slice(0,16)||"index"}catch{s="-"}return[`${s}.${hash(o)}`,...n.map(t=>[t,e.node.req.headers[t]]).map(([e,t])=>`${escapeKey(e)}.${hash(t)}`)].join(":")},validate:e=>!!e.value&&(!(e.value.code>=400)&&(void 0!==e.value.body&&("undefined"!==e.value.headers.etag&&"undefined"!==e.value.headers["last-modified"]))),group:t.group||"nitro/handlers",integrity:t.integrity||hash([e,t])},l=function(e,t={}){return defineCachedFunction(e,t)}(async r=>{const o={};for(const e of n){const t=r.node.req.headers[e];void 0!==t&&(o[e]=t)}const s=cloneWithProxy(r.node.req,{headers:o}),l={};let d;const u=cloneWithProxy(r.node.res,{statusCode:200,writableEnded:!1,writableFinished:!1,headersSent:!1,closed:!1,getHeader:e=>l[e],setHeader(e,t){return l[e]=t,this},getHeaderNames:()=>Object.keys(l),hasHeader:e=>e in l,removeHeader(e){delete l[e]},getHeaders:()=>l,end(e,t,n){return"string"==typeof e&&(d=e),"function"==typeof t&&t(),"function"==typeof n&&n(),this},write:(e,t,n)=>("string"==typeof e&&(d=e),"function"==typeof t&&t(void 0),"function"==typeof n&&n(),!0),writeHead(e,t){if(this.statusCode=e,t){if(Array.isArray(t)||"string"==typeof t)throw new TypeError("Raw headers  is not supported.");for(const e in t){const n=t[e];void 0!==n&&this.setHeader(e,n)}}return this}}),p=a(s,u);p.fetch=(e,t)=>i(p,e,t,{fetch:useNitroApp().localFetch}),p.$fetch=(e,t)=>i(p,e,t,{fetch:globalThis.$fetch}),p.waitUntil=r.waitUntil,p.context=r.context,p.context.cache={options:c};const f=await e(p)||d,m=p.node.res.getHeaders();m.etag=String(m.Etag||m.etag||`W/"${hash(f)}"`),m["last-modified"]=String(m["Last-Modified"]||m["last-modified"]||(new Date).toUTCString());const h=[];t.swr?(t.maxAge&&h.push(`s-maxage=${t.maxAge}`),t.staleMaxAge?h.push(`stale-while-revalidate=${t.staleMaxAge}`):h.push("stale-while-revalidate")):t.maxAge&&h.push(`max-age=${t.maxAge}`),h.length>0&&(m["cache-control"]=h.join(", "));return{code:p.node.res.statusCode,headers:m,body:f}},c);return r(async n=>{if(t.headersOnly){if(o(n,{maxAge:t.maxAge}))return;return e(n)}const r=await l(n);if(n.node.res.headersSent||n.node.res.writableEnded)return r.body;if(!o(n,{modifiedTime:new Date(r.headers["last-modified"]),etag:r.headers.etag,maxAge:t.maxAge})){n.node.res.statusCode=r.code;for(const e in r.headers){const t=r.headers[e];"set-cookie"===e?n.node.res.appendHeader(e,s(t)):void 0!==t&&n.node.res.setHeader(e,t)}return r.body}})},$e=Q({});function getEnv(t,r){const o=ye(t).toUpperCase();return n(e.env[r.prefix+o]??e.env[r.altPrefix+o])}function _isObject(e){return"object"==typeof e&&!Array.isArray(e)}function applyEnv(e,t,n=""){for(const r in e){const o=n?`${n}_${r}`:r,s=getEnv(o,t);_isObject(e[r])?_isObject(s)?(e[r]={...e[r],...s},applyEnv(e[r],t,o)):void 0===s?applyEnv(e[r],t,o):e[r]=s??e[r]:e[r]=s??e[r],t.envExpansion&&"string"==typeof e[r]&&(e[r]=_expandFromEnv(e[r]))}return e}const Te=/\{\{([^{}]*)\}\}/g;function _expandFromEnv(t){return t.replace(Te,(t,n)=>e.env[n]||t)}const We={app:{baseURL:"/"},nitro:{openAPI:{meta:{title:"My Awesome Project",description:"This might become the next big thing.",version:"1.0"},route:"/_docs/openapi.json",ui:{scalar:{route:"/_docs/scalar",theme:"purple"},swagger:!1}},routeRules:{}},env:"dev",runtime:"monolithic",isDev:!0,isProd:!1,baseURL:"https://localhost:undefined",db:{connectionString:""},openai:{apiKey:""},auth:{secret:"",social:{google:{clientId:"",clientSecret:""},kakao:{clientId:"",clientSecret:""}}},wrangler:{persistDir:"/Users/bino/Workspaces/nuxt-fullstack-starter/server/.wrangler/state/v3"}},ze={prefix:"NITRO_",altPrefix:We.nitro.envPrefix??e.env.NITRO_ENV_PREFIX??"_",envExpansion:We.nitro.envExpansion??e.env.NITRO_ENV_EXPANSION??!1},Oe=_deepFreeze(applyEnv(ke(We),ze));function useRuntimeConfig(e){if(!e)return Oe;if(e.context.nitro.runtimeConfig)return e.context.nitro.runtimeConfig;const t=ke(We);return applyEnv(t,ze),e.context.nitro.runtimeConfig=t,t}function _deepFreeze(e){const t=Object.getOwnPropertyNames(e);for(const n of t){const t=e[n];t&&"object"==typeof t&&_deepFreeze(t)}return Object.freeze(e)}_deepFreeze(ke($e)),new Proxy(Object.create(null),{get:(e,t)=>{console.warn("Please use `useRuntimeConfig()` instead of accessing config directly.");const n=useRuntimeConfig();if(t in n)return n[t]}});const Ie=X("nitro-app",{asyncContext:!0,AsyncLocalStorage:G}),He=ee(te({routes:useRuntimeConfig().nitro.routeRules}));function createRouteRulesHandler(e){return l(t=>{const n=function(e){e.context._nitro=e.context._nitro||{},e.context._nitro.routeRules||(e.context._nitro.routeRules=getRouteRulesForPath(I(e.path.split("?")[0],useRuntimeConfig().app.baseURL)));return e.context._nitro.routeRules}(t);if(n.headers&&d(t,n.headers),n.redirect){let e=n.redirect.to;if(e.endsWith("/**")){let r=t.path;const o=n.redirect._redirectStripBase;o&&(r=I(r,o)),e=H(e.slice(0,-3),r)}else if(t.path.includes("?")){const n=F(t.path);e=q(e,n)}return u(t,e,n.redirect.statusCode)}if(n.proxy){let r=n.proxy.to;if(r.endsWith("/**")){let e=t.path;const o=n.proxy._proxyStripBase;o&&(e=I(e,o)),r=H(r.slice(0,-3),e)}else if(t.path.includes("?")){const e=F(t.path);r=q(r,e)}return p(t,r,{fetch:e.localFetch,...n.proxy})}})}function getRouteRulesForPath(e){return Z({},...He.matchAll(e).reverse())}function _captureError(e,t){console.error(`[${t}]`,e),useNitroApp().captureError(e,{tags:[t]})}function joinHeaders(e){return Array.isArray(e)?e.join(", "):String(e)}function normalizeCookieHeader(e=""){return s(joinHeaders(e))}function normalizeCookieHeaders(e){const t=new Headers;for(const[n,r]of e)if("set-cookie"===n)for(const e of normalizeCookieHeader(r))t.append("set-cookie",e);else t.set(n,joinHeaders(r));return t}async function defaultHandler(t,n,r){const o=t.unhandled||t.fatal,s=t.statusCode||500,a=t.statusMessage||"Server Error",i=f(n,{xForwardedHost:!0,xForwardedProto:!0});if(404===s){const e="/";if(/^\/[^/]/.test(e)&&!i.pathname.startsWith(e)){return{status:302,statusText:"Found",headers:{location:`${e}${i.pathname.slice(1)}${i.search}`},body:"Redirecting..."}}}await loadStackTrace(t).catch(ae.error);const c=new ce;if(o&&!r?.silent){const r=[t.unhandled&&"[unhandled]",t.fatal&&"[fatal]"].filter(Boolean).join(" "),o=await(await c.toANSI(t)).replaceAll(e.cwd(),".");ae.error(`[request error] ${r} [${n.method}] ${i}\n\n`,o)}const l=r?.json||!m(n,"accept")?.includes("text/html"),d={"content-type":l?"application/json":"text/html","x-content-type-options":"nosniff","x-frame-options":"DENY","referrer-policy":"no-referrer","content-security-policy":"script-src 'self' 'unsafe-inline'; object-src 'none'; base-uri 'self';"};404!==s&&h(n,"cache-control")||(d["cache-control"]="no-cache");return{status:s,statusText:a,headers:d,body:l?{error:!0,url:i,statusCode:s,statusMessage:a,message:t.message,data:t.data,stack:t.stack?.split("\n").map(e=>e.trim())}:await c.toHTML(t,{request:{url:i.href,method:n.method,headers:g(n)}})}}async function loadStackTrace(e){if(!(e instanceof Error))return;const t=await(new ie).defineSourceLoader(sourceLoader).parse(e),n=e.message+"\n"+t.frames.map(e=>function(e){if("native"===e.type)return e.raw;const t=`${e.fileName||""}:${e.lineNumber}:${e.columnNumber})`;return e.functionName?`at ${e.functionName} (${t}`:`at ${t}`}(e)).join("\n");Object.defineProperty(e,"stack",{value:n}),e.cause&&await loadStackTrace(e.cause).catch(ae.error)}async function sourceLoader(e){if(!e.fileName||"fs"!==e.fileType||"native"===e.type)return;if("app"===e.type){const t=await ne(`${e.fileName}.map`,"utf8").catch(()=>{});if(t){const n=(await new le(t)).originalPositionFor({line:e.lineNumber,column:e.columnNumber});n.source&&n.line&&(e.fileName=re(oe(e.fileName),n.source),e.lineNumber=n.line,e.columnNumber=n.column||0)}}const t=await ne(e.fileName,"utf8").catch(()=>{});return t?{contents:t}:void 0}const Fe=[async function(e,t){const n=await defaultHandler(e,t);return t.node?.res.headersSent||b(t,n.headers),k(t,n.status,n.statusText),y(t,"string"==typeof n.body?n.body:JSON.stringify(n.body,null,2))}];const qe={},De={};const Le=async function(){const{getPlatformProxy:e}=await import("wrangler").catch(()=>{throw new Error("Package `wrangler` not found, please install it with: `npx nypm@latest add -D wrangler`")}),t=useRuntimeConfig(),n={configPath:t.wrangler.configPath,persist:{path:t.wrangler.persistDir}};t.wrangler.environment&&(n.environment=t.wrangler.environment);return await e(n)}().catch(e=>(console.error("Failed to initialize wrangler bindings proxy",e),{env:{},cf:{},ctx:{waitUntil(){},passThroughOnException(){}},caches:{open:()=>Promise.resolve(new _CacheStub),get default(){return new _CacheStub}},dispose:()=>Promise.resolve()})).then(e=>(globalThis.__env__=e.env,e));globalThis.__env__=Le.then(e=>e.env);class _CacheStub{delete(){return Promise.resolve(!1)}match(){return Promise.resolve(void 0)}put(){return Promise.resolve()}}const Me=[function(e){e.hooks.hook("request",async e=>{const t=await Le;e.context.cf=t.cf,e.context.waitUntil=t.ctx.waitUntil.bind(t.ctx);const n=new Request(f(e));n.cf=t.cf,e.context.cloudflare={...e.context.cloudflare,request:n,env:t.env,context:t.ctx},e.node.req.__unenv__={...e.node.req.__unenv__,waitUntil:e.context.waitUntil}}),e.hooks._hooks.request.unshift(e.hooks._hooks.request.pop()),e.hooks.hook("close",()=>Le?.then(e=>e.dispose))}],Ke={};const Be={};function getAsset(e){return Ke[e]}const Ve=new Set(["HEAD","GET"]),Je={gzip:".gz",br:".br"},Ge=l(e=>{if(e.method&&!Ve.has(e.method))return;let t,n=D(L(M(O(e.path).pathname)));const r=[...String(m(e,"accept-encoding")||"").split(",").map(e=>Je[e.trim()]).filter(Boolean).sort(),""];r.length>1&&_(e,"Vary","Accept-Encoding");for(const e of r)for(const r of[n+e,H(n,"index.html"+e)]){const e=getAsset(r);if(e){t=e,n=r;break}}if(!t){if(function(e=""){if(Ke[e])return!0;for(const t in Be)if(e.startsWith(t))return!0;return!1}(n))throw v(e,"Cache-Control"),w({statusCode:404});return}if(m(e,"if-none-match")===t.etag)return k(e,304,"Not Modified"),"";const o=m(e,"if-modified-since"),s=new Date(t.mtime);return o&&t.mtime&&new Date(o)>=s?(k(e,304,"Not Modified"),""):(t.type&&!h(e,"Content-Type")&&x(e,"Content-Type",t.type),t.etag&&!h(e,"ETag")&&x(e,"ETag",t.etag),t.mtime&&!h(e,"Last-Modified")&&x(e,"Last-Modified",s.toUTCString()),t.encoding&&!h(e,"Content-Encoding")&&x(e,"Content-Encoding",t.encoding),t.size>0&&!h(e,"Content-Length")&&x(e,"Content-Length",t.size),function(e){const t=pe(ue(globalThis._importMeta_.url));return de.readFile(fe(t,Ke[e].path))}(n))}),Xe=[{route:"/api/auth/**:all",method:void 0,meta:null},{route:"/api/health",method:void 0,meta:null},{route:"/_docs/openapi.json",method:void 0,meta:null},{route:"/_docs/scalar",method:void 0,meta:null}],Ze=l(e=>{const t=useRuntimeConfig(e),n=t.app?.baseURL,r=H(f(e).origin,n),o={title:"Nitro Server Routes",...t.nitro?.openAPI?.meta},{paths:s,globals:{components:a,...i}}=function(){const e={};let t={};for(const n of Xe){const{route:r,parameters:o}=normalizeRoute(n.route||""),s=defaultTags(n.route||""),a=(n.method||"get").toLowerCase(),{$global:i,...c}=n.meta?.openAPI||{},l={[a]:{tags:s,parameters:o,responses:{200:{description:"OK"}},...c}};i&&(t=Y(i,t)),void 0===e[r]?e[r]=l:Object.assign(e[r],l)}return{paths:e,globals:t}}(),c=Object.fromEntries(Object.entries(i).filter(([e])=>e.startsWith("x-")));return{openapi:"3.1.0",info:{title:o?.title,version:o?.version,description:o?.description},servers:[{url:r,description:"Local Development Server",variables:{}}],paths:s,components:a,...c}});function normalizeRoute(e){const t=[];let n=0;const r=e.replace(/:(\w+)/g,(e,t)=>`{${t}}`).replace(/\/(\*)\//g,()=>`/{param${++n}}/`).replace(/\*\*{/,"{").replace(/\/(\*\*)$/g,()=>`/{*param${++n}}`),o=r.matchAll(/{(\*?\w+)}/g);for(const e of o){const n=e[1];t.some(e=>e.name===n)||t.push({name:n,in:"path",required:!0,schema:{type:"string"}})}return{route:r,parameters:t}}function defaultTags(e){const t=[];return e.startsWith("/api/")?t.push("API Routes"):e.startsWith("/_")?t.push("Internal"):t.push("App Routes"),t}const Qe=l(e=>{const t=useRuntimeConfig(e),n=t.nitro.openAPI?.meta?.title||"API Reference",r=t.nitro.openAPI?.meta?.description||"",o=t.nitro.openAPI?.route||"./_openapi.json",s=t.nitro.openAPI?.ui?.scalar,a={...s,url:o,spec:{url:o,...s?.spec}};return`<!doctype html>\n    <html lang="en">\n      <head>\n        <meta charset="utf-8" />\n        <meta name="viewport" content="width=device-width, initial-scale=1" />\n        <meta name="description" content="${r}" />\n        <title>${n}</title>\n        <style>\n          ${a.theme?null:Ye}\n        </style>\n      </head>\n      <body>\n        <script\n          id="api-reference"\n          data-configuration="${JSON.stringify(a).split('"').join("&quot;")}"\n        ><\/script>\n        <script src="https://cdn.jsdelivr.net/npm/@scalar/api-reference"><\/script>\n      </body>\n    </html>`}),Ye='/* basic theme */\n  .light-mode,\n  .light-mode .dark-mode {\n    --theme-background-1: #fff;\n    --theme-background-2: #fafafa;\n    --theme-background-3: rgb(245 245 245);\n\n    --theme-color-1: #2a2f45;\n    --theme-color-2: #757575;\n    --theme-color-3: #8e8e8e;\n\n    --theme-color-accent: #ef4444;\n    --theme-background-accent: transparent;\n\n    --theme-border-color: rgba(0, 0, 0, 0.1);\n  }\n  .dark-mode {\n    --theme-background-1: #171717;\n    --theme-background-2: #262626;\n    --theme-background-3: #2e2e2e;\n\n    --theme-color-1: rgba(255, 255, 255, 0.9);\n    --theme-color-2: rgba(255, 255, 255, 0.62);\n    --theme-color-3: rgba(255, 255, 255, 0.44);\n\n    --theme-color-accent: #f87171;\n    --theme-background-accent: transparent;\n\n    --theme-border-color: rgba(255, 255, 255, 0.1);\n  }\n\n  /* Document Sidebar */\n  .light-mode .t-doc__sidebar,\n  .dark-mode .t-doc__sidebar {\n    --sidebar-background-1: var(--theme-background-1);\n    --sidebar-color-1: var(--theme-color-1);\n    --sidebar-color-2: var(--theme-color-2);\n    --sidebar-border-color: var(--theme-border-color);\n\n    --sidebar-item-hover-background: transparent;\n    --sidebar-item-hover-color: var(--sidebar-color-1);\n\n    --sidebar-item-active-background: var(--theme-background-accent);\n    --sidebar-color-active: var(--theme-color-accent);\n\n    --sidebar-search-background: transparent;\n    --sidebar-search-color: var(--theme-color-3);\n    --sidebar-search-border-color: var(--theme-border-color);\n  }\n\n  /* advanced */\n  .light-mode .dark-mode,\n  .light-mode {\n    --theme-color-green: #91b859;\n    --theme-color-red: #e53935;\n    --theme-color-yellow: #e2931d;\n    --theme-color-blue: #6182b8;\n    --theme-color-orange: #f76d47;\n    --theme-color-purple: #9c3eda;\n  }\n  .dark-mode {\n    --theme-color-green: #c3e88d;\n    --theme-color-red: #f07178;\n    --theme-color-yellow: #ffcb6b;\n    --theme-color-blue: #82aaff;\n    --theme-color-orange: #f78c6c;\n    --theme-color-purple: #c792ea;\n  }\n  /* custom-theme */\n  .section-container:nth-of-type(2)\n    ~ .section-container\n    .scalar-card\n    .scalar-card-header {\n    --theme-background-2: var(--theme-background-1) !important;\n  }\n  .section-flare {\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    top: 0;\n    left: 0;\n    animation: spin 39s linear infinite;\n    transition: all 0.3s ease-in-out;\n    opacity: 1;\n  }\n  .section-flare-item:nth-of-type(1),\n  .section-flare-item:nth-of-type(2),\n  .section-flare-item:nth-of-type(3) {\n    content: "";\n    width: 1000px;\n    height: 1000px;\n    position: absolute;\n    top: 0;\n    right: 0;\n    border-radius: 50%;\n    background: var(--default-theme-background-1);\n    display: block;\n    opacity: 1;\n    filter: blur(48px);\n    -webkit-backface-visibility: hidden;\n    -webkit-perspective: 1000;\n    -webkit-transform: translate3d(0, 0, 0);\n    -webkit-transform: translateZ(0);\n    perspective: 1000;\n    transform: translate3d(0, 0, 0);\n    transform: translateZ(0);\n  }\n  .section-flare-item:nth-of-type(2) {\n    top: initial;\n    right: initial;\n    background: #ef4444;\n    width: 700px;\n    height: 700px;\n    opacity: 0.3;\n    animation: sectionflare 37s linear infinite;\n  }\n  .section-flare-item:nth-of-type(1) {\n    top: initial;\n    right: initial;\n    bottom: 0;\n    left: -20px;\n    background: #ef4444;\n    width: 500px;\n    height: 500px;\n    opacity: 0.3;\n    animation: sectionflare2 38s linear infinite;\n  }\n  @keyframes sectionflare {\n    0%,\n    100% {\n      transform: translate3d(0, 0, 0);\n    }\n    50% {\n      transform: translate3d(525px, 525px, 0);\n    }\n  }\n  @keyframes sectionflare2 {\n    0%,\n    100% {\n      transform: translate3d(700px, 700px, 0);\n    }\n    50% {\n      transform: translate3d(0, 0, 0);\n    }\n  }\n  @keyframes spin {\n    100% {\n      transform: rotate(360deg);\n    }\n  }\n  .section-container:nth-of-type(2) {\n    overflow: hidden;\n  }',et=[{route:"",handler:Ge,lazy:!1,middleware:!0,method:void 0},{route:"/api/auth/**:all",handler:()=>Promise.resolve().then(function(){return ft}),lazy:!0,middleware:!1,method:void 0},{route:"/api/health",handler:()=>Promise.resolve().then(function(){return ht}),lazy:!0,middleware:!1,method:void 0},{route:"/_docs/openapi.json",handler:Ze,lazy:!1,middleware:!1,method:void 0},{route:"/_docs/scalar",handler:Qe,lazy:!1,middleware:!1,method:void 0}];const tt=function(){const e=useRuntimeConfig(),t=P(),captureError=(e,n={})=>{const r=t.callHookParallel("error",e,n).catch(e=>{console.error("Error while capturing another error",e)});if(n.event&&c(n.event)){const t=n.event.context.nitro?.errors;t&&t.push({error:e,context:n}),n.event.waitUntil&&n.event.waitUntil(r)}},r=U({debug:n(!0),onError:(e,t)=>(captureError(e,{event:t,tags:["request"]}),async function(e,t){for(const n of Fe)try{if(await n(e,t,{defaultHandler:defaultHandler}),t.handled)return}catch(e){console.error(e)}}(e,t)),onRequest:async e=>{e.context.nitro=e.context.nitro||{errors:[]};const t=e.node.req?.__unenv__;t?._platform&&(e.context={_platform:t?._platform,...t._platform,...e.context}),!e.context.waitUntil&&t?.waitUntil&&(e.context.waitUntil=t.waitUntil),e.fetch=(t,n)=>i(e,t,n,{fetch:localFetch}),e.$fetch=(t,n)=>i(e,t,n,{fetch:a}),e.waitUntil=t=>{e.context.nitro._waitUntilPromises||(e.context.nitro._waitUntilPromises=[]),e.context.nitro._waitUntilPromises.push(t),e.context.waitUntil&&e.context.waitUntil(t)},e.captureError=(t,n)=>{captureError(t,{event:e,...n})},await tt.hooks.callHook("request",e).catch(t=>{captureError(t,{event:e,tags:["request"]})})},onBeforeResponse:async(e,t)=>{await tt.hooks.callHook("beforeResponse",e,t).catch(t=>{captureError(t,{event:e,tags:["request","response"]})})},onAfterResponse:async(e,t)=>{await tt.hooks.callHook("afterResponse",e,t).catch(t=>{captureError(t,{event:e,tags:["request","response"]})})}}),o=A({preemptive:!0}),s=j(r),localFetch=(e,t)=>e.toString().startsWith("/")?W(s,e,t).then(e=>function(e){return e.headers.has("set-cookie")?new Response(e.body,{status:e.status,statusText:e.statusText,headers:normalizeCookieHeaders(e.headers)}):e}(e)):globalThis.fetch(e,t),a=$({fetch:localFetch,Headers:T,defaults:{baseURL:e.app.baseURL}});globalThis.$fetch=a,r.use(createRouteRulesHandler({localFetch:localFetch}));for(const t of et){let n=t.lazy?N(t.handler):t.handler;if(t.middleware||!t.route){const o=(e.app.baseURL+(t.route||"/")).replace(/\/+/g,"/");r.use(o,n)}else{const e=getRouteRulesForPath(t.route.replace(/:\w+|\*\*/g,"_"));e.cache&&(n=cachedEventHandler(n,{group:"nitro/routes",...e.cache})),o.use(t.route,n,t.method)}}r.use(e.app.baseURL,o.handler);{const e=r.handler;r.handler=t=>{const n={event:t};return Ie.callAsync(n,()=>e(t))}}return{hooks:t,h3App:r,router:o,localCall:e=>z(s,e),localFetch:localFetch,captureError:captureError}}();function useNitroApp(){return tt}!function(e){for(const t of Me)try{t(e)}catch(t){throw e.captureError(t,{tags:["plugin"]}),t}}(tt),globalThis.crypto||(globalThis.crypto=he);const{NITRO_NO_UNIX_SOCKET:nt,NITRO_DEV_WORKER_ID:rt}=e.env;e.on("unhandledRejection",e=>_captureError(e,"unhandledRejection")),e.on("uncaughtException",e=>_captureError(e,"uncaughtException")),ge?.on("message",e=>{e&&"shutdown"===e.event&&shutdown()});const ot=useNitroApp(),st=new me(j(ot.h3App));let at;function listen(n=Boolean(nt||e.versions.webcontainer||"Bun"in globalThis&&"win32"===e.platform)){return new Promise((r,o)=>{try{at=st.listen(n?0:function(){const n=`nitro-worker-${e.pid}-${be}-${rt}-${Math.round(1e4*Math.random())}.sock`;if("win32"===e.platform)return se(String.raw`\\.\pipe`,n);if("linux"===e.platform){if(Number.parseInt(e.versions.node.split(".")[0],10)>=20)return`\0${n}`}return se(t(),n)}(),()=>{const e=st.address();ge?.postMessage({event:"listen",address:"string"==typeof e?{socketPath:e}:{host:"localhost",port:e?.port}}),r()})}catch(e){o(e)}})}async function shutdown(){st.closeAllConnections?.(),await Promise.all([new Promise(e=>at?.close(e)),ot.hooks.callHook("close").catch(console.error)]),ge?.postMessage({event:"exit"})}listen().catch(()=>listen(!0)).catch(e=>(console.error("Dev worker failed to listen:",e),shutdown())),ot.router.get("/_nitro/tasks",r(async e=>{const t=await Promise.all(Object.entries(qe).map(async([e,t])=>{const n=await(t.resolve?.());return[e,{description:n?.meta?.description}]}));return{tasks:Object.fromEntries(t),scheduledTasks:false}})),ot.router.use("/_nitro/tasks/:name",r(async e=>{const t=R(e,"name"),n={...C(e),...await E(e).then(e=>e?.payload).catch(()=>({}))};return await async function(e,{payload:t={},context:n={}}={}){if(De[e])return De[e];if(!(e in qe))throw w({message:`Task \`${e}\` is not available!`,statusCode:404});if(!qe[e].resolve)throw w({message:`Task \`${e}\` is not implemented!`,statusCode:501});const r=await qe[e].resolve(),o={name:e,payload:t,context:n};De[e]=r.run(o);try{return await De[e]}finally{delete De[e]}}(t,{payload:n})}));const it=Ae("user",{id:Ne("id").primaryKey(),name:Ne("name").notNull(),email:Ne("email").notNull().unique(),emailVerified:Re("email_verified").$defaultFn(()=>!1).notNull(),image:Ne("image"),createdAt:je("created_at").$defaultFn(()=>new Date).notNull(),updatedAt:je("updated_at").$defaultFn(()=>new Date).notNull()}),ct=Ae("session",{id:Ne("id").primaryKey(),expiresAt:je("expires_at").notNull(),token:Ne("token").notNull().unique(),createdAt:je("created_at").notNull(),updatedAt:je("updated_at").notNull(),ipAddress:Ne("ip_address"),userAgent:Ne("user_agent"),userId:Ne("user_id").notNull().references(()=>it.id,{onDelete:"cascade"})}),lt=Ae("account",{id:Ne("id").primaryKey(),accountId:Ne("account_id").notNull(),providerId:Ne("provider_id").notNull(),userId:Ne("user_id").notNull().references(()=>it.id,{onDelete:"cascade"}),accessToken:Ne("access_token"),refreshToken:Ne("refresh_token"),idToken:Ne("id_token"),accessTokenExpiresAt:je("access_token_expires_at"),refreshTokenExpiresAt:je("refresh_token_expires_at"),scope:Ne("scope"),password:Ne("password"),createdAt:je("created_at").notNull(),updatedAt:je("updated_at").notNull()}),dt=Ae("verification",{id:Ne("id").primaryKey(),identifier:Ne("identifier").notNull(),value:Ne("value").notNull(),expiresAt:je("expires_at").notNull(),createdAt:je("created_at").$defaultFn(()=>new Date),updatedAt:je("updated_at").$defaultFn(()=>new Date)}),ut=Object.freeze({__proto__:null,account:lt,session:ct,user:it,verification:dt}),db=(t=e.env.DB_CONNECTION_STRING)=>{const n=xe(t||"");return Ue(n,{schema:ut})};const _Auth=({isDev:e,baseURL:t,auth:{secret:n,social:r},db:{connectionString:o}})=>we({baseURL:`${t}/auth`,trustedOrigins:[t],secret:n,database:_e(db(o),{provider:"pg",schema:ut}),plugins:[ve({config:[{providerId:"kakao",clientId:r.kakao.clientId,clientSecret:r.kakao.clientSecret,redirectURI:`${t}/api/auth/callback/kakao`,authorizationUrl:"https://kauth.kakao.com/oauth/authorize",tokenUrl:"https://kauth.kakao.com/oauth/token",userInfoUrl:"https://kapi.kakao.com/v2/user/me",discoveryUrl:"https://kauth.kakao.com/.well-known/openid-configuration",getUserInfo:async e=>{if(!e.accessToken)throw new Error("No access token on try to get user info from kakao");return async function(e){var t,n,r,o,s,a;try{const i=await fetch("https://kapi.kakao.com/v2/user/me",{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-type":"application/x-www-form-urlencoded;charset=utf-8"}});if(!i.ok)throw new Error("Failed to fetch user data");const c=await i.json();return{id:c.id,email:null==(t=c.kakao_account)?void 0:t.email,emailVerified:null==(n=c.kakao_account)?void 0:n.is_email_verified,name:null==(o=null==(r=c.kakao_account)?void 0:r.profile)?void 0:o.nickname,image:null==(a=null==(s=c.kakao_account)?void 0:s.profile)?void 0:a.profile_image_url,createdAt:c.connected_at,updatedAt:c.connected_at,_raw:c}}catch(e){throw console.error("Error fetching Kakao user data:",e),e}}(e.accessToken)},scopes:["profile_nickname","profile_image","account_email"],pkce:!0,responseType:"code"}]})],socialProviders:{google:{redirectURI:`${t}/api/auth/callback/google`,...r.google}},session:{expiresIn:5184e3,updateAge:604800},advanced:{cookiePrefix:"app-auth-session"},logger:{level:e?"debug":"info"}}),pt=r(e=>(()=>{const e=useRuntimeConfig();return _Auth(e)})().handler(S(e))),ft=Object.freeze({__proto__:null,default:pt}),mt=r(()=>"ok"),ht=Object.freeze({__proto__:null,default:mt});
//# sourceMappingURL=index.mjs.map
